<!DOCTYPE html>
<html lang="zh-Hans">
<head>
<title>可否用数组 includes 来取代条件集联判断 | Eczn's Home</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no,minimal-ui">
<meta name="format-detection" content="telephone=no">

<style id="CSS_VARS"></style>
<script>
(function() {
console.log('INIT CSS VAR');
function loadCSSVars() {
    const j = localStorage.getItem("CSS_VARS_2" /* STORAGE_KEY.CSS_VARS */);
    const initialVars = initialCSSVars();
    if (!j)
        return initialVars;
    try {
        const result = {
            ...initialVars,
            ...JSON.parse(j)
        };
        console.log('loadCSSVars from storage', result);
        return result;
    }
    catch (error) {
        console.error('load css vars with error', error);
        return initialVars;
    }
}
function renderCSSVars(vars, style) {
    const allDefine = Object.keys(vars).map(k => {
        const v = vars[k];
        const cssValue = typeof v === 'number' ? `${v}px` : v;
        return `--${k}:${cssValue};`;
    }).join('\n');
    if (style) {
        style.innerHTML = `:root { ${allDefine} }`;
    }
    else {
        console.error(`style#CSS_VARS NotFound !`);
    }
}
function initialCSSVars() {
    let rem = 16;
    // 移动端
    if (typeof window !== 'undefined' && window.innerWidth <= 500) {
        rem = Number(((window.innerWidth - 20) / 42).toFixed(1));
        console.log('mobile calculated rem =>', rem);
    }
    return {
        rem,
        enableSmallerFont: false,
        displayToc: 'block',
        fontSmcp: 'source serif pro, serif',
        fontCode: 'consolas, Menlo, monospace',
        fontTitle: 'Noto Serif SC, serif',
        fontArticle: 'source serif pro, LXGW WenKai',
        fontSansSerif: 'sans-serif',
    };
}
window.__initialCSSVars = loadCSSVars();
renderCSSVars(__initialCSSVars, document.querySelector('#CSS_VARS'));
})();
</script>

<link rel="icon" href="/favicon.png"><script defer="defer" src="/js/index.cfd76580.js"></script><script defer="defer" src="/js/chunk-lib.c90ce4c7.js"></script><link href="/css/index.719eaef39530924de6f6.css" rel="stylesheet"><link href="/css/chunk-lib.5c7d4887bb8714b00c54.css" rel="stylesheet"></head>
<body>
<noscript>当前浏览器不支持 JavaScript, 建议使用支持 JavaScript 的浏览器来访问此网站 !</noscript>
<div id="rally-bg" style="opacity:0"></div>
<div id="app"><div class="ball-canvas-container"></div><nav class="nav-main --fontSmcp"><div class="_title default-max-width">Eczn&#x27;s Home</div><div class="smcphr"></div><div class="_links default-max-width"><a class="r-link _link clickable r-link" href="/">Home</a><a class="r-link _link clickable r-link" href="/tl/0/">Timeline</a><a class="r-link _link clickable r-link" href="/cate/all/">Category</a><a class="r-link _link clickable r-link" href="/setting/">Setting</a><a class="r-link _link clickable r-link" href="/launchpad/">Launchpad</a></div></nav><div class="std-box rally-page-content default-max-width"><div id="blog-box" class="std-box-content "><div id="start" class="blog-header-main"><div class="_infos"><div class="_info"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="clock" class="svg-inline--fa fa-clock fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"></path></svg>2021-11-21</div></div><div class="_title --fontTitle">可否用数组 includes 来取代条件集联判断</div></div><article><div class="r-article"><div class="std-para --fontArticle" data-minimap-color="#CCCCCC">最近写 bug 有看到类似下面的代码：</div>
<div class="std-code"><pre class="prismjs ts rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">01</span>  <span class="token comment">// 说明 type 值落在数组 [a, b] 中</span>
<span style="user-select:none" class="line-numbers-rows">02</span>  <span class="token comment">// 逻辑上等价于 type === a || type === b</span>
<span style="user-select:none" class="line-numbers-rows">03</span><span class="token punctuation">}</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">这样绕一层不是偶然，问过相关写过的朋友，有的是因为这样可以绕过不友好的度量工具错杀这类横向可拓展的逻辑，有的是觉得这样更简短，可读性更高。</div>
<h1 id="横向可拓展-vs-意大利面式" class="std-title --fontTitle"><a target="_blank" href="#横向可拓展-vs-意大利面式" class="markdownIt-Anchor">#</a> 横向可拓展 vs 意大利面式<i data-minimap="Ignore"> ↵ </i></h1>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">一般来说，正常思路写很难写出上面的 includes hack，更多是用表驱动 / switch 语句等类似手段去处理，而大多数人这样写是为了应对代码复杂度度量而出现的 hack 手段，因为 includes 复杂度会大大降低，而 <code>||</code> 集联会导致复杂度暴涨，而前者降低的原因也很简单：编译器分析不了 includes 的语义，只把他当成函数调用，没有当作集联或来做具体分析造成。</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">此处用 includes 只是骗过了度量工具，没有解决问题。</div>
<div class="std-code"><pre class="prismjs ts rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token comment">// ⭕️ 横向可拓展的条件集</span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token keyword">if</span> <span class="token punctuation">(</span>
<span style="user-select:none" class="line-numbers-rows">02</span>  type <span class="token operator">===</span> a
<span style="user-select:none" class="line-numbers-rows">03</span>  <span class="token operator">||</span> type <span class="token operator">===</span> b
<span style="user-select:none" class="line-numbers-rows">04</span>  <span class="token operator">||</span> type <span class="token operator">===</span> c
<span style="user-select:none" class="line-numbers-rows">05</span>  <span class="token operator">||</span> type <span class="token operator">===</span> d
<span style="user-select:none" class="line-numbers-rows">06</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span style="user-select:none" class="line-numbers-rows">07</span>
<span style="user-select:none" class="line-numbers-rows">08</span><span class="token comment">// ❌ 🍜 意大利面式条件耦合</span>
<span style="user-select:none" class="line-numbers-rows">09</span><span class="token keyword">if</span> <span class="token punctuation">(</span>
<span style="user-select:none" class="line-numbers-rows">10</span>   <span class="token punctuation">(</span>type <span class="token operator">===</span> a <span class="token operator">||</span> name <span class="token operator">===</span> <span class="token string">&#x27;eczn&#x27;</span><span class="token punctuation">)</span>
<span style="user-select:none" class="line-numbers-rows">11</span>   <span class="token operator">&amp;&amp;</span> age <span class="token operator">&gt;=</span> <span class="token number">24</span>
<span style="user-select:none" class="line-numbers-rows">12</span>   <span class="token operator">&amp;&amp;</span> company <span class="token operator">===</span> <span class="token string">&#x27;google&#x27;</span>
<span style="user-select:none" class="line-numbers-rows">13</span>   <span class="token operator">||</span> bxxxTime <span class="token operator">&gt;=</span> userLastBxxxTime
<span style="user-select:none" class="line-numbers-rows">14</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">大部分人都会觉得后面那个才叫做复杂度，而前者这种横向可拓展的复杂度并不高，而对于前者，很多人可能会用表驱动 / switch 去处理，或者说 includes 不也挺好的嘛，而实际上，很多场景我们只有两个条件：</div>
<div class="std-code"><pre class="prismjs ts rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> a <span class="token operator">||</span> type <span class="token operator">===</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token keyword">const</span> conditionMap <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span style="user-select:none" class="line-numbers-rows">02</span><span class="token keyword">if</span> <span class="token punctuation">(</span>conditionMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">从可读性的角度上来看，这类处理是不是有点太过度设计/过度封装了？</div>
<h1 id="考察-includes-的语义" class="std-title --fontTitle"><a target="_blank" href="#考察-includes-的语义" class="markdownIt-Anchor">#</a> 考察 includes 的语义<i data-minimap="Ignore"> ↵ </i></h1>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">includes 仅是判断有无，直接用于此处本身意思上就不对上，阅读者读的时候得自己转换一层意思：</div>
<ol class="std-list">
<li>眼球读取到 <code>如果 type 包含在 [a, b] 之中 ... 则 ...</code></li>
<li>经过人脑翻译后意思等价于 <code>如果 type === a || type === b ... 则 ...</code></li>
</ol>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">高可读性代码里能避免的逻辑负担就尽量避免，此处用 includes 是可避免的，因此不推荐写 includes 直接 || 展开会更好。</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">从这个观点来看，只有在动态条件（即条件数组会在业务场景中变长变短）的情况下才必须用 includes 做动态集联或的判断，此外，includes 有更多的运行时开销，也不推荐（尤其是可以编译成二进制包的语言来说更不推荐）</div>
<h1 id="考察-includes-的类型" class="std-title --fontTitle"><a target="_blank" href="#考察-includes-的类型" class="markdownIt-Anchor">#</a> 考察 includes 的类型<i data-minimap="Ignore"> ↵ </i></h1>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">从业界多年的实践来看，由人来证明代码里的类型是靠不住的，编译器的证明更靠得住，所以这几年 js python 之类都开始搞静态类型系统，而新兴的编程语言更是清一色全部都有强大的静态类型 <s>(除了 golang doge)</s></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">为了更好的利用编译器对类型命题作证明的能力，我们更应该写更具体的类型给编译器做分析。</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">从这个角度上来看，我们应当先考察 includes 的类型：</div>
<div class="std-code"><pre class="prismjs ts rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token comment">// ts 源码对 includes 的声明</span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token keyword">interface</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">02</span>  <span class="token function">includes</span><span class="token punctuation">(</span>searchElement<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> fromIndex<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">03</span><span class="token punctuation">}</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">很明显，includes 甚至要求搜索的元素跟数组是同一个类型，这说明下面的语句是有问题的：</div>
<div class="std-code"><pre class="prismjs ts rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">declare</span> <span class="token keyword">const</span> retcodes<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token keyword">if</span> <span class="token punctuation">(</span>retcodes<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#x27;111&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">02</span>  <span class="token comment">// 这里过不了编译，会报错</span>
<span style="user-select:none" class="line-numbers-rows">03</span>  <span class="token comment">// 因为 string 不满足 retcodes 的元素限制</span>
<span style="user-select:none" class="line-numbers-rows">04</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">05</span>  <span class="token comment">// 业务 else 场景</span>
<span style="user-select:none" class="line-numbers-rows">06</span><span class="token punctuation">}</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">这种场景在业务中很常见，我们要判断用户操作不属于某个条件集，就应该做个弹窗提示啥的</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">而此处既然期望用 includes 来做条件集联或的判断，那么此处我们就不应该对 “用户操作” 做限制才对—— 亦即以下代码里 <code>用户操作 action 的类型</code> 应当不被限制才对，它可能是数字，甚至是 null, undeinfed 之类的，我们应该将其当作 unknown 处理</div>
<div class="std-code"><pre class="prismjs ts rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">if</span> <span class="token punctuation">(</span>
<span style="user-select:none" class="line-numbers-rows">01</span>  action <span class="token operator">===</span> <span class="token string">&#x27;A&#x27;</span>
<span style="user-select:none" class="line-numbers-rows">02</span>  <span class="token operator">||</span> action <span class="token operator">===</span> <span class="token string">&#x27;B&#x27;</span>
<span style="user-select:none" class="line-numbers-rows">03</span>  <span class="token operator">||</span> action <span class="token operator">===</span> <span class="token string">&#x27;C&#x27;</span>
<span style="user-select:none" class="line-numbers-rows">04</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">05</span>  <span class="token comment">// 业务 if-true 场景</span>
<span style="user-select:none" class="line-numbers-rows">06</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">07</span>  <span class="token comment">// 业务 else 场景</span>
<span style="user-select:none" class="line-numbers-rows">08</span><span class="token punctuation">}</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">而大部分情况我们会将 action 声明为 <code>string</code>，然后将条件集声明为 <code>string[]</code>，从而逃过了这个问题，也因此，目前 includes 无法实现如下静态分析/推断：</div>
<div class="std-code"><pre class="prismjs ts rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">if</span> <span class="token punctuation">(</span>
<span style="user-select:none" class="line-numbers-rows">01</span>  <span class="token punctuation">[</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;b&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span style="user-select:none" class="line-numbers-rows">02</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">03</span>  <span class="token comment">// c 在这里应当推断为 &#x27;a&#x27; | &#x27;b&#x27;</span>
<span style="user-select:none" class="line-numbers-rows">04</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">05</span>  <span class="token comment">// 如果 c 的类型是 &#x27;a&#x27; | &#x27;b&#x27; | &#x27;c&#x27;</span>
<span style="user-select:none" class="line-numbers-rows">06</span>  <span class="token comment">// 那么这里 c 的应当推断为 &#x27;c&#x27;</span>
<span style="user-select:none" class="line-numbers-rows">07</span><span class="token punctuation">}</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">那么有没有办法魔改，可以改下声明：</div>
<div class="std-code"><pre class="prismjs ts rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">declare</span> global <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">01</span>  <span class="token keyword">interface</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">02</span>    <span class="token function">ecznIncludes</span><span class="token punctuation">(</span>elem<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">)</span><span class="token operator">:</span> elem <span class="token keyword">is</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">03</span>  <span class="token punctuation">}</span>
<span style="user-select:none" class="line-numbers-rows">04</span><span class="token punctuation">}</span>
<span style="user-select:none" class="line-numbers-rows">05</span><span class="token comment">// @ts-ignore 后面扩大化了, 忽略</span>
<span style="user-select:none" class="line-numbers-rows">06</span><span class="token builtin">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>ecznIncludes <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>includes<span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">07</span>
<span style="user-select:none" class="line-numbers-rows">08</span><span class="token comment">// test</span>
<span style="user-select:none" class="line-numbers-rows">09</span><span class="token keyword">declare</span> <span class="token keyword">const</span> c<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">10</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;b&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ecznIncludes</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">11</span>  <span class="token keyword">type</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token operator">=</span> <span class="token keyword">typeof</span> c<span class="token punctuation">;</span> <span class="token comment">// C is string</span>
<span style="user-select:none" class="line-numbers-rows">12</span><span class="token punctuation">}</span></pre></div>
<h1 id="其他语言如何处理" class="std-title --fontTitle"><a target="_blank" href="#其他语言如何处理" class="markdownIt-Anchor">#</a> 其他语言如何处理 ?<i data-minimap="Ignore"> ↵ </i></h1>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">模式匹配解决一切 “横向可拓展” 的问题：</div>
<div class="std-code"><pre class="prismjs haskell rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token comment">-- haskell</span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token hvariable">fib</span> <span class="token hvariable">n</span> <span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token number">1</span>
<span style="user-select:none" class="line-numbers-rows">02</span>      <span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">1</span>
<span style="user-select:none" class="line-numbers-rows">03</span>      <span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">&gt;=</span> <span class="token number">2</span> <span class="token operator">=</span> <span class="token hvariable">fib</span> <span class="token punctuation">(</span><span class="token hvariable">n</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token hvariable">fib</span> <span class="token punctuation">(</span><span class="token hvariable">n</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span></pre></div>
<div class="std-code"><pre class="prismjs ss rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token comment">;; lisp 家族: 形如下面的结构</span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">mapRetcodeMessage</span> code<span class="token punctuation">)</span>
<span style="user-select:none" class="line-numbers-rows">02</span>  <span class="token punctuation">(</span><span class="token function">match</span> code
<span style="user-select:none" class="line-numbers-rows">03</span>    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token string">&quot;成功&quot;</span><span class="token punctuation">)</span>
<span style="user-select:none" class="line-numbers-rows">04</span>     <span class="token punctuation">(</span><span class="token number">1</span> <span class="token string">&quot;空间不足&quot;</span><span class="token punctuation">)</span>
<span style="user-select:none" class="line-numbers-rows">05</span>     <span class="token punctuation">(</span><span class="token number">2</span> <span class="token string">&quot;用户无权限&quot;</span><span class="token punctuation">)</span>
<span style="user-select:none" class="line-numbers-rows">06</span>     <span class="token punctuation">(</span><span class="token symbol">&#x27;default</span> <span class="token string">&quot;接口错误请重试&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></div>
<div class="std-code"><pre class="prismjs swift rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token comment">// Swift 两位二进制 转 十进制字符串</span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token keyword">let</span> bool1 <span class="token operator">=</span> <span class="token number">1</span>
<span style="user-select:none" class="line-numbers-rows">02</span><span class="token keyword">let</span> bool2 <span class="token operator">=</span> <span class="token number">0</span>
<span style="user-select:none" class="line-numbers-rows">03</span><span class="token keyword">switch</span> <span class="token punctuation">(</span>bool1<span class="token punctuation">,</span> bool2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">04</span>  <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;0&quot;</span></span><span class="token punctuation">)</span>
<span style="user-select:none" class="line-numbers-rows">05</span>  <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;1&quot;</span></span><span class="token punctuation">)</span>
<span style="user-select:none" class="line-numbers-rows">06</span>  <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;2&quot;</span></span><span class="token punctuation">)</span>
<span style="user-select:none" class="line-numbers-rows">07</span>  <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;3&quot;</span></span><span class="token punctuation">)</span>
<span style="user-select:none" class="line-numbers-rows">08</span><span class="token punctuation">}</span></pre></div>
<h1 id="一个推荐的做法" class="std-title --fontTitle"><a target="_blank" href="#一个推荐的做法" class="markdownIt-Anchor">#</a> 一个推荐的做法<i data-minimap="Ignore"> ↵ </i></h1>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">现阶段 TypeScript 并不支持 if 或 switch 里的模式匹配，因此解决这类问题可能需要一点特别的技巧，比如借助 enum 反射、结合表驱动的思想来做：</div>
<div class="std-code"><pre class="prismjs ts rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">enum</span> UserOperation <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">01</span>  <span class="token constant">OPEN</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
<span style="user-select:none" class="line-numbers-rows">02</span>  <span class="token constant">CLOSE</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span style="user-select:none" class="line-numbers-rows">03</span>  <span class="token comment">// 注: ts 不支持 enum string value 的反射, 所以这里是数字</span>
<span style="user-select:none" class="line-numbers-rows">04</span>  <span class="token comment">// 如果一定要字符串，请保证 key 名和 value 一致, 如 OPEN = &#x27;OPEN&#x27;</span>
<span style="user-select:none" class="line-numbers-rows">05</span><span class="token punctuation">}</span>
<span style="user-select:none" class="line-numbers-rows">06</span>
<span style="user-select:none" class="line-numbers-rows">07</span><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;UserOperation&#x27;</span><span class="token punctuation">,</span> UserOperation<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">08</span>
<span style="user-select:none" class="line-numbers-rows">09</span><span class="token keyword">function</span> <span class="token function">onUserClick1</span><span class="token punctuation">(</span>o<span class="token operator">:</span> UserOperation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">10</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>UserOperation<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">11</span>    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;合法 operation, keyName 是&#x27;</span><span class="token punctuation">,</span> UserOperation<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">12</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">13</span>    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;非法 operation&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">14</span>  <span class="token punctuation">}</span>
<span style="user-select:none" class="line-numbers-rows">15</span><span class="token punctuation">}</span>
<span style="user-select:none" class="line-numbers-rows">16</span>
<span style="user-select:none" class="line-numbers-rows">17</span><span class="token function">onUserClick1</span><span class="token punctuation">(</span>UserOperation<span class="token punctuation">.</span><span class="token constant">OPEN</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div>
<h1 id="末尾" class="std-title --fontTitle"><a target="_blank" href="#末尾" class="markdownIt-Anchor">#</a> 末尾<i data-minimap="Ignore"> ↵ </i></h1>
<ol class="std-list">
<li>度量工具应该需要支持豁免横向可拓展的 if 判断的复杂度计数</li>
<li>考虑到可读性以及静态类型，综上 <code>[].includes</code> 做集联条件判断并不好</li>
<li>TypeScript 或 tc39 理应推出更强大的模式匹配，而不是仅满足于解构赋值这类基础的模式匹配</li>
</ol>
</div></article></div></div><div class="smcphr rally-page-smcphr"></div><div class="std-box rally-giscus-wrapper default-max-width"><div class="std-box-content "></div></div></div>
<script>window.__INITIAL_STATE__ = {"CategoryApiState":{"loaded":false,"loading":false,"error":null,"dataMap":{}},"BlogApiState":{"loaded":true,"loading":false,"error":null,"dataMap":{"should-we-use-array-includes-for-condition-connection":{"type":"markdown","meta":{"id":"should-we-use-array-includes-for-condition-connection","title":"可否用数组 includes 来取代条件集联判断","date":"2021-11-21 01:02:20","category":"编程语言","tags":[],"type":"article","appTitle":"","intro":"未定义 intro","cateIntro":"该分类暂无介绍 ~","author":"eczn","imgs":[],"time":"2021-11-20T17:02:20.000Z","isDraft":false,"fileDeps":[],"wordCount":4033},"nodes":[{"type":"tag","children":[{"type":"text","data":"最近写 bug 有看到类似下面的代码："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"if"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"a"},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" b"},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"includes"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"type"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// 说明 type 值落在数组 [a, b] 中"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// 逻辑上等价于 type === a || type === b"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs ts rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"这样绕一层不是偶然，问过相关写过的朋友，有的是因为这样可以绕过不友好的度量工具错杀这类横向可拓展的逻辑，有的是觉得这样更简短，可读性更高。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#横向可拓展-vs-意大利面式","className":"markdownIt-Anchor"}},{"type":"text","data":" 横向可拓展 vs 意大利面式"}],"name":"h1","attribs":{"id":"横向可拓展-vs-意大利面式"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"一般来说，正常思路写很难写出上面的 includes hack，更多是用表驱动 / switch 语句等类似手段去处理，而大多数人这样写是为了应对代码复杂度度量而出现的 hack 手段，因为 includes 复杂度会大大降低，而 "},{"type":"tag","children":[{"type":"text","data":"||"}],"name":"code","attribs":{}},{"type":"text","data":" 集联会导致复杂度暴涨，而前者降低的原因也很简单：编译器分析不了 includes 的语义，只把他当成函数调用，没有当作集联或来做具体分析造成。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"此处用 includes 只是骗过了度量工具，没有解决问题。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// ⭕️ 横向可拓展的条件集"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"if"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  type "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" a\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"||"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" type "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" b\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"||"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" type "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" c\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"||"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" type "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" d\n"},{"type":"tag","children":[{"type":"text","data":"06"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"07"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"08"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// ❌ 🍜 意大利面式条件耦合"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"09"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"if"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"10"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"   "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"type "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" a "},{"type":"tag","children":[{"type":"text","data":"||"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" name "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'eczn'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"11"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"   "},{"type":"tag","children":[{"type":"text","data":"&amp;&amp;"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" age "},{"type":"tag","children":[{"type":"text","data":">="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"24"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"12"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"   "},{"type":"tag","children":[{"type":"text","data":"&amp;&amp;"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" company "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'google'"}],"name":"span","attribs":{"className":"token string"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"13"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"   "},{"type":"tag","children":[{"type":"text","data":"||"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" bxxxTime "},{"type":"tag","children":[{"type":"text","data":">="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" userLastBxxxTime\n"},{"type":"tag","children":[{"type":"text","data":"14"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs ts rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"大部分人都会觉得后面那个才叫做复杂度，而前者这种横向可拓展的复杂度并不高，而对于前者，很多人可能会用表驱动 / switch 去处理，或者说 includes 不也挺好的嘛，而实际上，很多场景我们只有两个条件："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"if"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"type "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" a "},{"type":"tag","children":[{"type":"text","data":"||"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" type "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" b"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"/* ... */"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"const"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" conditionMap "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" a"},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"true"}],"name":"span","attribs":{"className":"token boolean"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" b"},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"true"}],"name":"span","attribs":{"className":"token boolean"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"if"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"conditionMap"},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"type"},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"/* ... */"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs ts rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"从可读性的角度上来看，这类处理是不是有点太过度设计/过度封装了？"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#考察-includes-的语义","className":"markdownIt-Anchor"}},{"type":"text","data":" 考察 includes 的语义"}],"name":"h1","attribs":{"id":"考察-includes-的语义"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"includes 仅是判断有无，直接用于此处本身意思上就不对上，阅读者读的时候得自己转换一层意思："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"眼球读取到 "},{"type":"tag","children":[{"type":"text","data":"如果 type 包含在 [a, b] 之中 ... 则 ..."}],"name":"code","attribs":{}}],"name":"li","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"经过人脑翻译后意思等价于 "},{"type":"tag","children":[{"type":"text","data":"如果 type === a || type === b ... 则 ..."}],"name":"code","attribs":{}}],"name":"li","attribs":{}},{"type":"text","data":"\n"}],"name":"ol","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"高可读性代码里能避免的逻辑负担就尽量避免，此处用 includes 是可避免的，因此不推荐写 includes 直接 || 展开会更好。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"从这个观点来看，只有在动态条件（即条件数组会在业务场景中变长变短）的情况下才必须用 includes 做动态集联或的判断，此外，includes 有更多的运行时开销，也不推荐（尤其是可以编译成二进制包的语言来说更不推荐）"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#考察-includes-的类型","className":"markdownIt-Anchor"}},{"type":"text","data":" 考察 includes 的类型"}],"name":"h1","attribs":{"id":"考察-includes-的类型"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"从业界多年的实践来看，由人来证明代码里的类型是靠不住的，编译器的证明更靠得住，所以这几年 js python 之类都开始搞静态类型系统，而新兴的编程语言更是清一色全部都有强大的静态类型 "},{"type":"tag","children":[{"type":"text","data":"(除了 golang doge)"}],"name":"s","attribs":{}}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"为了更好的利用编译器对类型命题作证明的能力，我们更应该写更具体的类型给编译器做分析。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"从这个角度上来看，我们应当先考察 includes 的类型："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// ts 源码对 includes 的声明"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"interface"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"Array"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":"&lt;"}],"name":"span","attribs":{"className":"token operator"}},{"type":"tag","children":[{"type":"text","data":"T"}],"name":"span","attribs":{"className":"token constant"}},{"type":"tag","children":[{"type":"text","data":">"}],"name":"span","attribs":{"className":"token operator"}}],"name":"span","attribs":{"className":"token class-name"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"includes"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"searchElement"},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"T"}],"name":"span","attribs":{"className":"token constant"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" fromIndex"},{"type":"tag","children":[{"type":"text","data":"?"}],"name":"span","attribs":{"className":"token operator"}},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"number"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"boolean"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs ts rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"很明显，includes 甚至要求搜索的元素跟数组是同一个类型，这说明下面的语句是有问题的："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"declare"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"const"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" retcodes"},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"number"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"if"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"retcodes"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"includes"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"'111'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// 这里过不了编译，会报错"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// 因为 string 不满足 retcodes 的元素限制"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"else"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// 业务 else 场景"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"06"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs ts rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"这种场景在业务中很常见，我们要判断用户操作不属于某个条件集，就应该做个弹窗提示啥的"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"而此处既然期望用 includes 来做条件集联或的判断，那么此处我们就不应该对 “用户操作” 做限制才对—— 亦即以下代码里 "},{"type":"tag","children":[{"type":"text","data":"用户操作 action 的类型"}],"name":"code","attribs":{}},{"type":"text","data":" 应当不被限制才对，它可能是数字，甚至是 null, undeinfed 之类的，我们应该将其当作 unknown 处理"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"if"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  action "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'A'"}],"name":"span","attribs":{"className":"token string"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"||"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" action "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'B'"}],"name":"span","attribs":{"className":"token string"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"||"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" action "},{"type":"tag","children":[{"type":"text","data":"==="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'C'"}],"name":"span","attribs":{"className":"token string"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// 业务 if-true 场景"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"06"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"else"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"07"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// 业务 else 场景"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"08"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs ts rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"而大部分情况我们会将 action 声明为 "},{"type":"tag","children":[{"type":"text","data":"string"}],"name":"code","attribs":{}},{"type":"text","data":"，然后将条件集声明为 "},{"type":"tag","children":[{"type":"text","data":"string[]"}],"name":"code","attribs":{}},{"type":"text","data":"，从而逃过了这个问题，也因此，目前 includes 无法实现如下静态分析/推断："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"if"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"'a'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'b'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"includes"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"c"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// c 在这里应当推断为 'a' | 'b'"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"else"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// 如果 c 的类型是 'a' | 'b' | 'c'"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"06"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// 那么这里 c 的应当推断为 'c'"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"07"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs ts rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"那么有没有办法魔改，可以改下声明："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"declare"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" global "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"interface"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"Array"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":"&lt;"}],"name":"span","attribs":{"className":"token operator"}},{"type":"tag","children":[{"type":"text","data":"T"}],"name":"span","attribs":{"className":"token constant"}},{"type":"tag","children":[{"type":"text","data":">"}],"name":"span","attribs":{"className":"token operator"}}],"name":"span","attribs":{"className":"token class-name"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"ecznIncludes"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"elem"},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"unknown"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" elem "},{"type":"tag","children":[{"type":"text","data":"is"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"T"}],"name":"span","attribs":{"className":"token constant"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// @ts-ignore 后面扩大化了, 忽略"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"06"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"Array"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"prototype"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"ecznIncludes "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"Array"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"prototype"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"includes"},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"07"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"08"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// test"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"09"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"declare"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"const"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" c"},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"unknown"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"10"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"if"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"'a'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'b'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"ecznIncludes"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"c"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"11"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"type"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"C"}],"name":"span","attribs":{"className":"token constant"}}],"name":"span","attribs":{"className":"token class-name"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"typeof"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" c"},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"// C is string"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"12"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs ts rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#其他语言如何处理","className":"markdownIt-Anchor"}},{"type":"text","data":" 其他语言如何处理 ?"}],"name":"h1","attribs":{"id":"其他语言如何处理"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"模式匹配解决一切 “横向可拓展” 的问题："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"-- haskell"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"fib"}],"name":"span","attribs":{"className":"token hvariable"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"n"}],"name":"span","attribs":{"className":"token hvariable"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"|"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"n"}],"name":"span","attribs":{"className":"token hvariable"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"=="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"      "},{"type":"tag","children":[{"type":"text","data":"|"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"n"}],"name":"span","attribs":{"className":"token hvariable"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"=="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"      "},{"type":"tag","children":[{"type":"text","data":"|"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"n"}],"name":"span","attribs":{"className":"token hvariable"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":">="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"2"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"fib"}],"name":"span","attribs":{"className":"token hvariable"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"n"}],"name":"span","attribs":{"className":"token hvariable"}},{"type":"tag","children":[{"type":"text","data":"-"}],"name":"span","attribs":{"className":"token operator"}},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"+"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"fib"}],"name":"span","attribs":{"className":"token hvariable"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"n"}],"name":"span","attribs":{"className":"token hvariable"}},{"type":"tag","children":[{"type":"text","data":"-"}],"name":"span","attribs":{"className":"token operator"}},{"type":"tag","children":[{"type":"text","data":"2"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs haskell rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":";; lisp 家族: 形如下面的结构"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"define"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"mapRetcodeMessage"}],"name":"span","attribs":{"className":"token function"}},{"type":"text","data":" code"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"match"}],"name":"span","attribs":{"className":"token function"}},{"type":"text","data":" code\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"\"成功\""}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"     "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"\"空间不足\""}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"     "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"2"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"\"用户无权限\""}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"06"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"     "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"'default"}],"name":"span","attribs":{"className":"token symbol"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"\"接口错误请重试\""}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs ss rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// Swift 两位二进制 转 十进制字符串"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"let"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" bool1 "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"let"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" bool2 "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"switch"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"bool1"},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" bool2"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"case"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"print"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"\"0\""}],"name":"span","attribs":{"className":"token string"}}],"name":"span","attribs":{"className":"token string-literal"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"case"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"print"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"\"1\""}],"name":"span","attribs":{"className":"token string"}}],"name":"span","attribs":{"className":"token string-literal"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"06"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"case"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"print"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"\"2\""}],"name":"span","attribs":{"className":"token string"}}],"name":"span","attribs":{"className":"token string-literal"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"07"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"case"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"print"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"\"3\""}],"name":"span","attribs":{"className":"token string"}}],"name":"span","attribs":{"className":"token string-literal"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"08"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs swift rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#一个推荐的做法","className":"markdownIt-Anchor"}},{"type":"text","data":" 一个推荐的做法"}],"name":"h1","attribs":{"id":"一个推荐的做法"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"现阶段 TypeScript 并不支持 if 或 switch 里的模式匹配，因此解决这类问题可能需要一点特别的技巧，比如借助 enum 反射、结合表驱动的思想来做："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"enum"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" UserOperation "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"OPEN"}],"name":"span","attribs":{"className":"token constant"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"CLOSE"}],"name":"span","attribs":{"className":"token constant"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"2"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// 注: ts 不支持 enum string value 的反射, 所以这里是数字"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"// 如果一定要字符串，请保证 key 名和 value 一致, 如 OPEN = 'OPEN'"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"06"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"07"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"console"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"log"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"'UserOperation'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" UserOperation"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"08"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"09"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"function"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"onUserClick1"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"o"},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" UserOperation"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"10"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"if"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"UserOperation"},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"o"},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"11"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"console"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"log"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"'合法 operation, keyName 是'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" UserOperation"},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"o"},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"12"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"else"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"13"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"console"}],"name":"span","attribs":{"className":"token builtin"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"log"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"'非法 operation'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"14"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"  "},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"15"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"16"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"17"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"onUserClick1"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"UserOperation"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"OPEN"}],"name":"span","attribs":{"className":"token constant"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs ts rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#末尾","className":"markdownIt-Anchor"}},{"type":"text","data":" 末尾"}],"name":"h1","attribs":{"id":"末尾"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"度量工具应该需要支持豁免横向可拓展的 if 判断的复杂度计数"}],"name":"li","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"考虑到可读性以及静态类型，综上 "},{"type":"tag","children":[{"type":"text","data":"[].includes"}],"name":"code","attribs":{}},{"type":"text","data":" 做集联条件判断并不好"}],"name":"li","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"TypeScript 或 tc39 理应推出更强大的模式匹配，而不是仅满足于解构赋值这类基础的模式匹配"}],"name":"li","attribs":{}},{"type":"text","data":"\n"}],"name":"ol","attribs":{}},{"type":"text","data":"\n"}],"rawContent":""}}},"HomeApi":{"loaded":false,"loading":false,"error":null,"dataMap":{}},"TimeLineApiState":{"loaded":false,"loading":false,"error":null,"dataMap":{}},"SettingApi":{"loaded":false,"loading":false,"error":null,"dataMap":{}},"LaunchpadApi":{"loaded":false,"loading":false,"error":null,"dataMap":{}}}</script>
<!--SCRIPT-->
</body>
</html>
