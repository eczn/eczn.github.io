<!DOCTYPE html>
<html lang="zh-Hans">
<head>
<title>类数组对象和数组的对象本质 | Eczn's Home</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no,minimal-ui">
<meta name="format-detection" content="telephone=no">

<style id="CSS_VARS"></style>
<script>
(function() {
console.log('INIT CSS VAR');
function loadCSSVars() {
    const j = localStorage.getItem("CSS_VARS_2" /* STORAGE_KEY.CSS_VARS */);
    const initialVars = initialCSSVars();
    if (!j)
        return initialVars;
    try {
        const result = {
            ...initialVars,
            ...JSON.parse(j)
        };
        console.log('loadCSSVars from storage', result);
        return result;
    }
    catch (error) {
        console.error('load css vars with error', error);
        return initialVars;
    }
}
function renderCSSVars(vars, style) {
    const allDefine = Object.keys(vars).map(k => {
        const v = vars[k];
        const cssValue = typeof v === 'number' ? `${v}px` : v;
        return `--${k}:${cssValue};`;
    }).join('\n');
    if (style) {
        style.innerHTML = `:root { ${allDefine} }`;
    }
    else {
        console.error(`style#CSS_VARS NotFound !`);
    }
}
function initialCSSVars() {
    let rem = 16;
    // 移动端
    if (typeof window !== 'undefined' && window.innerWidth <= 500) {
        rem = Number(((window.innerWidth - 20) / 42).toFixed(1));
        console.log('mobile calculated rem =>', rem);
    }
    return {
        rem,
        enableSmallerFont: false,
        displayToc: 'block',
        fontSmcp: 'source serif pro, serif',
        fontCode: 'consolas, Menlo, monospace',
        fontTitle: 'Noto Serif SC, serif',
        fontArticle: 'source serif pro, LXGW WenKai',
        fontSansSerif: 'sans-serif',
    };
}
window.__initialCSSVars = loadCSSVars();
renderCSSVars(__initialCSSVars, document.querySelector('#CSS_VARS'));
})();
</script>

<link rel="icon" href="/favicon.png"><script defer="defer" src="/js/index.9d1819bc.js"></script><script defer="defer" src="/js/chunk-lib.cbf60312.js"></script><link href="/css/index.80eac14b882774b3688a.css" rel="stylesheet"><link href="/css/chunk-lib.5c7d4887bb8714b00c54.css" rel="stylesheet"></head>
<body x-apple-data-detectors="none">
<noscript>当前浏览器不支持 JavaScript, 建议使用支持 JavaScript 的浏览器来访问此网站 !</noscript>
<div id="rally-bg" style="opacity:0"></div>
<div id="app"><div class="ball-canvas-container"></div><nav class="nav-main --fontSmcp"><div class="_title default-max-width">Eczn&#x27;s Home</div><div class="smcphr"></div><div class="_links default-max-width"><a class="r-link _link clickable r-link" href="/">Home</a><a class="r-link _link clickable r-link" href="/tl/0/">Timeline</a><a class="r-link _link clickable r-link" href="/cate/all/">Category</a><a class="r-link _link clickable r-link" href="/setting/">Setting</a><a class="r-link _link clickable r-link" href="/launchpad/">Launchpad</a></div></nav><div class="std-box rally-page-content default-max-width"><div id="blog-box" class="std-box-content "><div id="start" class="blog-header-main"><div class="_infos"><div class="_info"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="clock" class="svg-inline--fa fa-clock fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"></path></svg>2017-07-20</div><div class="_info"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tag" class="svg-inline--fa fa-tag fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"></path></svg>Array</div></div><div class="_title --fontTitle">类数组对象和数组的对象本质</div></div><article class="r-article-wrapper"><div class="toc-wrapper"></div><div class="r-article"><div class="std-para --fontArticle" data-minimap-color="#CCCCCC">在编写 JavaScript 的过程中，总是会遇到类数组对象，比如函数执行的时候的 <code>arguments</code> 对象，还有一些 DOM 方法也会返回类数组对象，比如 getElementsByClassName 就会返回一个类数组对象，表示一个 DOM 集合。</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">接触 JavaScript 一年多了，把这段时间里对它的认识写了一下，我认为类数组对象的存在是合理的，不应该算是 JavaScript 设计的槽点，原因在于 JavaScript 的数组是用对象实现的，而不是我们寻常知道的经典数组 ———— 由一个索引偏移，还有对应其基地址的指针构成的线性空间。</div>
<h1 id="类数组对象" class="std-title --fontTitle"><a target="_blank" href="#类数组对象" class="markdownIt-Anchor">#</a> 类数组对象<i data-minimap="Ignore"> ↵ </i></h1>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">类数组对象指的是形如下面的这类对象：</div>
<div class="std-code"><pre class="prismjs js rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">var</span> likeArray <span class="token operator">=</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">01</span>    <span class="token number">0</span><span class="token operator">:</span> <span class="token string">&#x27;A&#x27;</span><span class="token punctuation">,</span> 
<span style="user-select:none" class="line-numbers-rows">02</span>    <span class="token number">1</span><span class="token operator">:</span> <span class="token string">&#x27;B&#x27;</span><span class="token punctuation">,</span>
<span style="user-select:none" class="line-numbers-rows">03</span>    <span class="token number">2</span><span class="token operator">:</span> <span class="token string">&#x27;C&#x27;</span><span class="token punctuation">,</span>
<span style="user-select:none" class="line-numbers-rows">04</span>    <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">3</span>
<span style="user-select:none" class="line-numbers-rows">05</span><span class="token punctuation">}</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">它们不是真正的数组，但是却异常地像数组：</div>
<div class="std-code"><pre class="prismjs js rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
<span style="user-select:none" class="line-numbers-rows">01</span>    likeArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span style="user-select:none" class="line-numbers-rows">02</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">03</span><span class="token comment">// =&gt; </span>
<span style="user-select:none" class="line-numbers-rows">04</span><span class="token comment">// &#x27;A&#x27;</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">稍加操作即可让类数组对象使用数组原生方法：</div>
<div class="std-code"><pre class="prismjs js rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">var</span> <span class="token function-variable function">print</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>likeArray<span class="token punctuation">,</span> print<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">02</span><span class="token comment">// =&gt; </span>
<span style="user-select:none" class="line-numbers-rows">03</span><span class="token comment">// &#x27;A&#x27;</span>
<span style="user-select:none" class="line-numbers-rows">04</span><span class="token comment">// &#x27;B&#x27;</span>
<span style="user-select:none" class="line-numbers-rows">05</span><span class="token comment">// &#x27;C&#x27;</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">利用 <code>slice</code> 或者 <code>Array.from</code> 可以由其生成一个真正的数组：</div>
<div class="std-code"><pre class="prismjs js rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
<span style="user-select:none" class="line-numbers-rows">01</span>    Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>likeArray<span class="token punctuation">)</span>， 
<span style="user-select:none" class="line-numbers-rows">02</span>    <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>likeArray<span class="token punctuation">)</span>
<span style="user-select:none" class="line-numbers-rows">03</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div>
<h1 id="真实的数组" class="std-title --fontTitle"><a target="_blank" href="#真实的数组" class="markdownIt-Anchor">#</a> 真实的数组<i data-minimap="Ignore"> ↵ </i></h1>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">我认为，像 C 语言那样的真实线性内存空间所代表的可存储区域，才叫做真实的数组，而 JavaScript 的数组是用对象的属性查找实现的，也就是说，在执行表达式 <code>likeArray[0]</code> 的时候，其实就是 <code>likeArray.0</code> 这跟 <code>likeArray[&quot;key2property&quot;]</code> 没什么两样，只是属性名不一样。</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">这样来看，JavaScript 数组的性能会比经典数组要慢很多。</div>
<h1 id="尝试创建一个尽可能像数组的类数组对象" class="std-title --fontTitle"><a target="_blank" href="#尝试创建一个尽可能像数组的类数组对象" class="markdownIt-Anchor">#</a> 尝试创建一个尽可能像数组的类数组对象<i data-minimap="Ignore"> ↵ </i></h1>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">数组之所以是数组，不过是 length 及其不同项的索引在其实例上对应着不同的值而已。</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">如果想要让某个类数组对象很像很像很像数组，只需要具备以下条件：</div>
<ol class="std-list">
<li>该类数组对象的原型链应该最终可以抵达 Array.prototype</li>
<li>需要有索引属性以及对应的正确的 length 属性</li>
</ol>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">满足上述两点，根据数组的对象本质，这时候我们大可以合理认为，这种类数组已经跟普通数组一样了。</div>
<div class="std-code"><pre class="prismjs js rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token comment">// FakeArray.js </span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token keyword">function</span> <span class="token function">FakeArray</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">02</span>    <span class="token comment">// 各索引值 </span>
<span style="user-select:none" class="line-numbers-rows">03</span>    arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> idx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">04</span>        <span class="token keyword">this</span><span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">05</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">06</span>
<span style="user-select:none" class="line-numbers-rows">07</span>    <span class="token comment">// 长度</span>
<span style="user-select:none" class="line-numbers-rows">08</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">09</span><span class="token punctuation">}</span>
<span style="user-select:none" class="line-numbers-rows">10</span>
<span style="user-select:none" class="line-numbers-rows">11</span><span class="token comment">// 创建一个对象继承自 Array.prototype </span>
<span style="user-select:none" class="line-numbers-rows">12</span><span class="token keyword">var</span> FakeArrayProto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">13</span>
<span style="user-select:none" class="line-numbers-rows">14</span><span class="token comment">// 连接到构造器上 </span>
<span style="user-select:none" class="line-numbers-rows">15</span><span class="token class-name">FakeArray</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> FakeArrayProto
<span style="user-select:none" class="line-numbers-rows">16</span>
<span style="user-select:none" class="line-numbers-rows">17</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> FakeArray<span class="token punctuation">;</span></pre></div>
<hr class="std-hr"/>
<div class="std-code"><pre class="prismjs js rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">var</span> likeArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FakeArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;i&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;am&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;fake&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;array&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">01</span>
<span style="user-select:none" class="line-numbers-rows">02</span><span class="token comment">// forEach </span>
<span style="user-select:none" class="line-numbers-rows">03</span>likeArray<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">04</span>
<span style="user-select:none" class="line-numbers-rows">05</span><span class="token comment">// join </span>
<span style="user-select:none" class="line-numbers-rows">06</span>likeArray<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#x27; &#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">07</span>
<span style="user-select:none" class="line-numbers-rows">08</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>likeArray<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">09</span><span class="token comment">// =&gt; </span>
<span style="user-select:none" class="line-numbers-rows">10</span><span class="token comment">// false</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC"><div class="std-img"><img class="std-img-bg r-link" data-minimap="Rect" src="/images/arraylikeobject.png" alt="创建 FakeArray 对象"/><div class="std-img-text">创建 FakeArray 对象</div></div></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">而且，甚至浏览器在打印我们的假数组的时候也把它作为真数组来打印了，当然 <code>Array.isArray</code> 还是能正常工作的，它能够判断到底是不是真的数组。</div>
<h1 id="对象本质" class="std-title --fontTitle"><a target="_blank" href="#对象本质" class="markdownIt-Anchor">#</a> 对象本质<i data-minimap="Ignore"> ↵ </i></h1>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">JavaScript 数组是用对象实现的，它跟其他对象并没有什么本质不同，唯一的区别在于它用整数来作为他的属性名，并假装成数组的索引来使用，而对于如何取得索引对应的值，经典数组是用基地址 + 索引偏移来寻找数组元素的，反观对象数组，它是利用哈希算法来将值放到堆的某个地方的，抛却如何寻找数组元素这一层来看，不论是经典数组还是对象数组，其本质在于把一个整数区间映射到一组值上，这是它们两者更加深层的内在本质。</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">相比经典数组，对象数组的优势在于：</div>
<ol class="std-list">
<li>其本身就是稀疏数组来用</li>
<li>其本身就是变长数组</li>
<li>其本身就是一个对象，可以直接添加方法</li>
</ol>
<h1 id="性能" class="std-title --fontTitle"><a target="_blank" href="#性能" class="markdownIt-Anchor">#</a> 性能<i data-minimap="Ignore"> ↵ </i></h1>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">关于数组的性能我主要参考了这篇文章 <a target="_blank" href="https://gamealchemist.wordpress.com/2013/05/01/lets-get-those-javascript-arrays-to-work-fast/" style="background-color:#f2f8f9" class="std-link --fontSansSerif  _line" data-minimap-color="#f2f8f9"><span class="std-link-icon r-link" data-src="/get-favicon/gamealchemist.wordpress.com?h=9008968637" style="background-image:url(&quot;/get-favicon/gamealchemist.wordpress.com?h=9008968637&quot;)"></span><span class="std-link-txt">Let’s get those Javascript Arrays to work fast</span></a></div>
<h2 id="使用有类型数组-typed-array" class="std-title --fontTitle"><a target="_blank" href="#使用有类型数组-typed-array" class="markdownIt-Anchor">#</a> 使用有类型数组 (Typed Array)</h2>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">具体请看 <a target="_blank" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Typed_arrays" style="background-color:#ebf7e8" class="std-link --fontSansSerif  _line" data-minimap-color="#ebf7e8"><span class="std-link-icon r-link" data-src="/get-favicon/developer.mozilla.org?h=-9488963965" style="background-image:url(&quot;/get-favicon/developer.mozilla.org?h=-9488963965&quot;)"></span><span class="std-link-txt">类型化数组架构</span></a> 这个我曾在之前做 HTML5 Audio API 那里的波形频域时域信息就是用这种数组保存的。</div>
<h2 id="比-要好" class="std-title --fontTitle"><a target="_blank" href="#比-要好" class="markdownIt-Anchor">#</a> [] 比 {} 要好</h2>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">作者认为 [] 比 {} 要好，因为他认为数组是用 number 类型的值做属性名而不是对象的字符串，不过，我认为这两者应该是没有区别的，在做 <code>[0][0]</code> 的时候我认为其中会发生类型转化，表达式将会被解释成 <code>[0][&quot;0&quot;]</code> 也就是说并无二致，数组的性能说不定还要更差一些。</div>
<h2 id="不要反过来遍历数组" class="std-title --fontTitle"><a target="_blank" href="#不要反过来遍历数组" class="markdownIt-Anchor">#</a> 不要反过来遍历数组</h2>
<div class="std-code"><pre class="prismjs js rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">var</span> i <span class="token operator">=</span> myArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token keyword">while</span> <span class="token punctuation">(</span> i<span class="token operator">--</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span style="user-select:none" class="line-numbers-rows">02</span>    process myArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">...</span>
<span style="user-select:none" class="line-numbers-rows">03</span><span class="token punctuation">}</span></pre></div>
<blockquote lang="en" class="std-quote"><span class="std-quote-text">
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">this will be much slower than using the right order. Because all CPU caches in the world expect the processing to be ‘straight’, you will have cache misses again and again, and a 2X slow down is what you’ll get when you are lucky.</div>
</span></blockquote>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">作者认为，上述的代码性能会很差，因为这会造成 CPU Cache 命中率大幅降低，因为这个世界上所有的 CPU 都期望执行过程是直线的 (straight)</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC"><strong>不过我自己写的简单测试却显示几乎没有什么区别，作者的说法有可能是错误的。</strong></div>
<h2 id="不要随意改变数组的长度" class="std-title --fontTitle"><a target="_blank" href="#不要随意改变数组的长度" class="markdownIt-Anchor">#</a> 不要随意改变数组的长度</h2>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">每一次的数组长度变化都可能是一次内存分配或者回收，如果频繁这样操作可能导致数组性能大幅度降低。</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">但是总不能就是不改长度把，对于这一点，坐着给出两个比较可行的策略：</div>
<ol class="std-list">
<li>任何时候都尽量操作固定长度的数组</li>
<li>使用长度比较大的数组来对付需要改变长度的任务 （Using over-sized array is way better than changing often the size.）</li>
</ol>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">对于第二点他给出了一段代码：</div>
<div class="std-code"><pre class="prismjs js rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">var</span> <span class="token constant">B</span> <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span>    <span class="token comment">// allocated array of length 5.</span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token keyword">var</span> BLength <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">02</span><span class="token comment">// to do a &#x27;push&#x27;, do </span>
<span style="user-select:none" class="line-numbers-rows">03</span><span class="token constant">B</span><span class="token punctuation">[</span> BLength<span class="token operator">++</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">04</span><span class="token comment">// to do a &#x27;pop&#x27; :</span>
<span style="user-select:none" class="line-numbers-rows">05</span><span class="token keyword">var</span> last <span class="token operator">=</span> <span class="token constant">B</span><span class="token punctuation">[</span> <span class="token operator">--</span>BLength  <span class="token punctuation">]</span> <span class="token punctuation">;</span></pre></div>
<h2 id="任何时候尽量使用预定义的数组" class="std-title --fontTitle"><a target="_blank" href="#任何时候尽量使用预定义的数组" class="markdownIt-Anchor">#</a> 任何时候尽量使用预定义的数组</h2>
<div class="std-code"><pre class="prismjs js rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token keyword">var</span> myArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">02</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">03</span><span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span> myArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">这是作者给出的代码，并认为这段代码会比用 <code>push</code> 快十倍 <a target="_blank" href="http://jsperf.com/push-allocated-vs-dynamic" style="background-color:#ece2f9" class="std-link --fontSansSerif  _line" data-minimap-color="#ece2f9"><span class="std-link-icon r-link" data-src="/get-favicon/jsperf.com?h=7717009296" style="background-image:url(&quot;/get-favicon/jsperf.com?h=7717009296&quot;)"></span><span class="std-link-txt">push-allocated-vs-dynamic</span></a></div>
<h2 id="用自己写的-push-unshift-splice-等等这些原生方法" class="std-title --fontTitle"><a target="_blank" href="#用自己写的-push-unshift-splice-等等这些原生方法" class="markdownIt-Anchor">#</a> 用自己写的 push unshift splice 等等这些原生方法</h2>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">他认为这些都是函数调用，函数调用是有代价的，应该用简单的表达式取代他们。</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">本人不敢苟同这点，这样把抽象带来的好处都丢了。</div>
<h2 id="空间换时间" class="std-title --fontTitle"><a target="_blank" href="#空间换时间" class="markdownIt-Anchor">#</a> 空间换时间</h2>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">原标题是 <code>Could i never de-allocate my arrays ? Yes, you can !</code></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">这段作者认为栈操作可以写下面这样</div>
<div class="std-code"><pre class="prismjs js rally-runner  "><span style="user-select:none" class="line-numbers-rows">00</span><span class="token keyword">var</span> myStack <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">01</span><span class="token keyword">var</span> myStacksLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span style="user-select:none" class="line-numbers-rows">02</span><span class="token comment">// to do a push :</span>
<span style="user-select:none" class="line-numbers-rows">03</span>myStack<span class="token punctuation">[</span>myStacksLenght<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span> 
<span style="user-select:none" class="line-numbers-rows">04</span><span class="token comment">// to do a pop :</span>
<span style="user-select:none" class="line-numbers-rows">05</span><span class="token keyword">var</span> val <span class="token operator">=</span>  myStack<span class="token punctuation">[</span>myStacksLength<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// you might want to check </span>
<span style="user-select:none" class="line-numbers-rows">06</span>                                      <span class="token comment">// myStacksLenght before...</span></pre></div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">这样可以尽可能的避免分配和收回内存了。</div>
<h1 id="think-it-as-an-object" class="std-title --fontTitle"><a target="_blank" href="#think-it-as-an-object" class="markdownIt-Anchor">#</a> Think It As An Object<i data-minimap="Ignore"> ↵ </i></h1>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">因为 JavaScript 的数组其实就是用对象来实现的，因此类数组对象的存在完全合理，也不应该是所谓 “糟粕” 。</div>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">通过构造器 <code>FakeArray</code> 我们可以构造出极像数组的类数组对象，它完全拥有数组的全部原生方法，在一般情况下，我们可以合理认为，它跟普通数组并无二致了。</div>
<hr class="std-hr"/>
<div class="std-para --fontArticle" data-minimap-color="#CCCCCC">后面的大部分在讨论性能问题，我刚刚自己试了下主要的结论是：</div>
<ol class="std-list">
<li><code>push</code> <code>pop</code> 这些改变数组长度的操作确实挺慢的</li>
<li>反过来遍历几乎不会有什么影响</li>
<li><code>arr[0]</code> VS <code>arr[&quot;0&quot;]</code> 几乎没有区别</li>
<li><code>([])[0]</code> VS <code>({})[0]</code> 几乎没有区别</li>
</ol>
</div></article></div></div><div class="smcphr rally-page-smcphr"></div><div class="std-box rally-giscus-wrapper default-max-width"><div class="std-box-content "></div></div></div>
<script>window.__INITIAL_STATE__ = {"CategoryApiState":{"loaded":false,"loading":false,"error":null,"dataMap":{}},"BlogApiState":{"loaded":true,"loading":false,"error":null,"dataMap":{"37c0deefc1d51e0e24fe3eeae2a41bf8":{"type":"markdown","meta":{"title":"类数组对象和数组的对象本质","intro":"JavaScript 的数组其实是由对象实现的。","date":"Thu Jul 20 2017 23:51:46 GMT+0800 (中国标准时间)","category":"JavaScript","tags":["Array"],"head":false,"headerStyle":["line-height: 314px;"],"headPic":false,"type":"article","id":"37c0deefc1d51e0e24fe3eeae2a41bf8","appTitle":"","appIcon":"","cateIntro":"该分类暂无介绍 ~","author":"eczn","imgs":[],"time":"2017-07-20T15:51:46.000Z","isDraft":false,"fileDeps":["/images/arraylikeobject.png"],"wordCount":4855},"nodes":[{"type":"tag","children":[{"type":"text","data":"在编写 JavaScript 的过程中，总是会遇到类数组对象，比如函数执行的时候的 "},{"type":"tag","children":[{"type":"text","data":"arguments"}],"name":"code","attribs":{}},{"type":"text","data":" 对象，还有一些 DOM 方法也会返回类数组对象，比如 getElementsByClassName 就会返回一个类数组对象，表示一个 DOM 集合。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"接触 JavaScript 一年多了，把这段时间里对它的认识写了一下，我认为类数组对象的存在是合理的，不应该算是 JavaScript 设计的槽点，原因在于 JavaScript 的数组是用对象实现的，而不是我们寻常知道的经典数组 ———— 由一个索引偏移，还有对应其基地址的指针构成的线性空间。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#类数组对象","className":"markdownIt-Anchor"}},{"type":"text","data":" 类数组对象"}],"name":"h1","attribs":{"id":"类数组对象"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"类数组对象指的是形如下面的这类对象："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" likeArray "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'A'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'B'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"2"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'C'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"length"}],"name":"span","attribs":{"className":"token literal-property property"}},{"type":"tag","children":[{"type":"text","data":":"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"3"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs js rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"它们不是真正的数组，但是却异常地像数组："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"console"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"log"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    likeArray"},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// => "}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// 'A'"}],"name":"span","attribs":{"className":"token comment"}}],"name":"pre","attribs":{"className":"prismjs js rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"稍加操作即可让类数组对象使用数组原生方法："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"print"}],"name":"span","attribs":{"className":"token function-variable function"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"x"}],"name":"span","attribs":{"className":"token parameter"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"=>"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" console"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"log"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"x"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"Array"}],"name":"span","attribs":{"className":"token class-name"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"prototype"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"forEach"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"call"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"likeArray"},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" print"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// => "}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// 'A'"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// 'B'"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// 'C'"}],"name":"span","attribs":{"className":"token comment"}}],"name":"pre","attribs":{"className":"prismjs js rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"利用 "},{"type":"tag","children":[{"type":"text","data":"slice"}],"name":"code","attribs":{}},{"type":"text","data":" 或者 "},{"type":"tag","children":[{"type":"text","data":"Array.from"}],"name":"code","attribs":{}},{"type":"text","data":" 可以由其生成一个真正的数组："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"console"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"log"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    Array"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"from"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"likeArray"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"， \n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"Array"}],"name":"span","attribs":{"className":"token class-name"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"prototype"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"slice"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"call"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"likeArray"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs js rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#真实的数组","className":"markdownIt-Anchor"}},{"type":"text","data":" 真实的数组"}],"name":"h1","attribs":{"id":"真实的数组"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"我认为，像 C 语言那样的真实线性内存空间所代表的可存储区域，才叫做真实的数组，而 JavaScript 的数组是用对象的属性查找实现的，也就是说，在执行表达式 "},{"type":"tag","children":[{"type":"text","data":"likeArray[0]"}],"name":"code","attribs":{}},{"type":"text","data":" 的时候，其实就是 "},{"type":"tag","children":[{"type":"text","data":"likeArray.0"}],"name":"code","attribs":{}},{"type":"text","data":" 这跟 "},{"type":"tag","children":[{"type":"text","data":"likeArray[&quot;key2property&quot;]"}],"name":"code","attribs":{}},{"type":"text","data":" 没什么两样，只是属性名不一样。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"这样来看，JavaScript 数组的性能会比经典数组要慢很多。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#尝试创建一个尽可能像数组的类数组对象","className":"markdownIt-Anchor"}},{"type":"text","data":" 尝试创建一个尽可能像数组的类数组对象"}],"name":"h1","attribs":{"id":"尝试创建一个尽可能像数组的类数组对象"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"数组之所以是数组，不过是 length 及其不同项的索引在其实例上对应着不同的值而已。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"如果想要让某个类数组对象很像很像很像数组，只需要具备以下条件："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"该类数组对象的原型链应该最终可以抵达 Array.prototype"}],"name":"li","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"需要有索引属性以及对应的正确的 length 属性"}],"name":"li","attribs":{}},{"type":"text","data":"\n"}],"name":"ol","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"满足上述两点，根据数组的对象本质，这时候我们大可以合理认为，这种类数组已经跟普通数组一样了。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// FakeArray.js "}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"function"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"FakeArray"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"arr"}],"name":"span","attribs":{"className":"token parameter"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"// 各索引值 "}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    arr"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"forEach"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"val"},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" idx"}],"name":"span","attribs":{"className":"token parameter"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"=>"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"        "},{"type":"tag","children":[{"type":"text","data":"this"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"idx"},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" val"},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"06"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"07"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"// 长度"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"08"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"this"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"length "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" arr"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"length"},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"09"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"10"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"11"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// 创建一个对象继承自 Array.prototype "}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"12"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" FakeArrayProto "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" Object"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"create"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"Array"}],"name":"span","attribs":{"className":"token class-name"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"prototype"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"13"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"14"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// 连接到构造器上 "}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"15"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"FakeArray"}],"name":"span","attribs":{"className":"token class-name"}},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"prototype "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" FakeArrayProto\n"},{"type":"tag","children":[{"type":"text","data":"16"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"17"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"module"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"exports "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" FakeArray"},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs js rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[],"name":"hr","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" likeArray "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"new"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"FakeArray"}],"name":"span","attribs":{"className":"token class-name"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"'i'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'am'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'fake'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"'array'"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// forEach "}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"likeArray"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"forEach"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"e"}],"name":"span","attribs":{"className":"token parameter"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"=>"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" console"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"log"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"e"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// join "}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"06"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"likeArray"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"join"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"' '"}],"name":"span","attribs":{"className":"token string"}},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"07"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"08"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"Array"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":"isArray"}],"name":"span","attribs":{"className":"token function"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"likeArray"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"09"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// => "}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"10"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// false"}],"name":"span","attribs":{"className":"token comment"}}],"name":"pre","attribs":{"className":"prismjs js rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[],"name":"img","attribs":{"src":"/images/arraylikeobject.png","alt":"创建 FakeArray 对象"}}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"而且，甚至浏览器在打印我们的假数组的时候也把它作为真数组来打印了，当然 "},{"type":"tag","children":[{"type":"text","data":"Array.isArray"}],"name":"code","attribs":{}},{"type":"text","data":" 还是能正常工作的，它能够判断到底是不是真的数组。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#对象本质","className":"markdownIt-Anchor"}},{"type":"text","data":" 对象本质"}],"name":"h1","attribs":{"id":"对象本质"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"JavaScript 数组是用对象实现的，它跟其他对象并没有什么本质不同，唯一的区别在于它用整数来作为他的属性名，并假装成数组的索引来使用，而对于如何取得索引对应的值，经典数组是用基地址 + 索引偏移来寻找数组元素的，反观对象数组，它是利用哈希算法来将值放到堆的某个地方的，抛却如何寻找数组元素这一层来看，不论是经典数组还是对象数组，其本质在于把一个整数区间映射到一组值上，这是它们两者更加深层的内在本质。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"相比经典数组，对象数组的优势在于："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"其本身就是稀疏数组来用"}],"name":"li","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"其本身就是变长数组"}],"name":"li","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"其本身就是一个对象，可以直接添加方法"}],"name":"li","attribs":{}},{"type":"text","data":"\n"}],"name":"ol","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#性能","className":"markdownIt-Anchor"}},{"type":"text","data":" 性能"}],"name":"h1","attribs":{"id":"性能"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"关于数组的性能我主要参考了这篇文章 "},{"type":"tag","children":[{"type":"text","data":"Let’s get those Javascript Arrays to work fast"}],"name":"a","attribs":{"href":"https://gamealchemist.wordpress.com/2013/05/01/lets-get-those-javascript-arrays-to-work-fast/"}}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#使用有类型数组-typed-array","className":"markdownIt-Anchor"}},{"type":"text","data":" 使用有类型数组 (Typed Array)"}],"name":"h2","attribs":{"id":"使用有类型数组-typed-array"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"具体请看 "},{"type":"tag","children":[{"type":"text","data":"类型化数组架构"}],"name":"a","attribs":{"href":"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Typed_arrays"}},{"type":"text","data":" 这个我曾在之前做 HTML5 Audio API 那里的波形频域时域信息就是用这种数组保存的。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#比-要好","className":"markdownIt-Anchor"}},{"type":"text","data":" [] 比 {} 要好"}],"name":"h2","attribs":{"id":"比-要好"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"作者认为 [] 比 {} 要好，因为他认为数组是用 number 类型的值做属性名而不是对象的字符串，不过，我认为这两者应该是没有区别的，在做 "},{"type":"tag","children":[{"type":"text","data":"[0][0]"}],"name":"code","attribs":{}},{"type":"text","data":" 的时候我认为其中会发生类型转化，表达式将会被解释成 "},{"type":"tag","children":[{"type":"text","data":"[0][&quot;0&quot;]"}],"name":"code","attribs":{}},{"type":"text","data":" 也就是说并无二致，数组的性能说不定还要更差一些。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#不要反过来遍历数组","className":"markdownIt-Anchor"}},{"type":"text","data":" 不要反过来遍历数组"}],"name":"h2","attribs":{"id":"不要反过来遍历数组"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" i "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" myArray"},{"type":"tag","children":[{"type":"text","data":"."}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"length"},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"while"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" i"},{"type":"tag","children":[{"type":"text","data":"--"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"    process myArray"},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"i"},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"..."}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs js rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"this will be much slower than using the right order. Because all CPU caches in the world expect the processing to be ‘straight’, you will have cache misses again and again, and a 2X slow down is what you’ll get when you are lucky."}],"name":"p","attribs":{}},{"type":"text","data":"\n"}],"name":"blockquote","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"作者认为，上述的代码性能会很差，因为这会造成 CPU Cache 命中率大幅降低，因为这个世界上所有的 CPU 都期望执行过程是直线的 (straight)"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"不过我自己写的简单测试却显示几乎没有什么区别，作者的说法有可能是错误的。"}],"name":"strong","attribs":{}}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#不要随意改变数组的长度","className":"markdownIt-Anchor"}},{"type":"text","data":" 不要随意改变数组的长度"}],"name":"h2","attribs":{"id":"不要随意改变数组的长度"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"每一次的数组长度变化都可能是一次内存分配或者回收，如果频繁这样操作可能导致数组性能大幅度降低。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"但是总不能就是不改长度把，对于这一点，坐着给出两个比较可行的策略："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"任何时候都尽量操作固定长度的数组"}],"name":"li","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"使用长度比较大的数组来对付需要改变长度的任务 （Using over-sized array is way better than changing often the size.）"}],"name":"li","attribs":{}},{"type":"text","data":"\n"}],"name":"ol","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"对于第二点他给出了一段代码："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"B"}],"name":"span","attribs":{"className":"token constant"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"    "},{"type":"tag","children":[{"type":"text","data":"// allocated array of length 5."}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" BLength "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// to do a 'push', do "}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"B"}],"name":"span","attribs":{"className":"token constant"}},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" BLength"},{"type":"tag","children":[{"type":"text","data":"++"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"1"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// to do a 'pop' :"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" last "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"B"}],"name":"span","attribs":{"className":"token constant"}},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"--"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":"BLength  "},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs js rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#任何时候尽量使用预定义的数组","className":"markdownIt-Anchor"}},{"type":"text","data":" 任何时候尽量使用预定义的数组"}],"name":"h2","attribs":{"id":"任何时候尽量使用预定义的数组"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" n "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"1000"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" myArray "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"new"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"Array"}],"name":"span","attribs":{"className":"token class-name"}},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"n"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" i"},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"while"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"("}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"i"},{"type":"tag","children":[{"type":"text","data":"&lt;"}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":"n"},{"type":"tag","children":[{"type":"text","data":")"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"{"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" myArray"},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"i"},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" i"},{"type":"tag","children":[{"type":"text","data":"++"}],"name":"span","attribs":{"className":"token operator"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"}"}],"name":"span","attribs":{"className":"token punctuation"}}],"name":"pre","attribs":{"className":"prismjs js rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"这是作者给出的代码，并认为这段代码会比用 "},{"type":"tag","children":[{"type":"text","data":"push"}],"name":"code","attribs":{}},{"type":"text","data":" 快十倍 "},{"type":"tag","children":[{"type":"text","data":"push-allocated-vs-dynamic"}],"name":"a","attribs":{"href":"http://jsperf.com/push-allocated-vs-dynamic"}}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#用自己写的-push-unshift-splice-等等这些原生方法","className":"markdownIt-Anchor"}},{"type":"text","data":" 用自己写的 push unshift splice 等等这些原生方法"}],"name":"h2","attribs":{"id":"用自己写的-push-unshift-splice-等等这些原生方法"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"他认为这些都是函数调用，函数调用是有代价的，应该用简单的表达式取代他们。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"本人不敢苟同这点，这样把抽象带来的好处都丢了。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#空间换时间","className":"markdownIt-Anchor"}},{"type":"text","data":" 空间换时间"}],"name":"h2","attribs":{"id":"空间换时间"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"原标题是 "},{"type":"tag","children":[{"type":"text","data":"Could i never de-allocate my arrays ? Yes, you can !"}],"name":"code","attribs":{}}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"这段作者认为栈操作可以写下面这样"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"00"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" myStack "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":","}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"01"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" myStacksLength "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"0"}],"name":"span","attribs":{"className":"token number"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"02"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// to do a push :"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"03"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"myStack"},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"myStacksLenght"},{"type":"tag","children":[{"type":"text","data":"++"}],"name":"span","attribs":{"className":"token operator"}},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":" value"},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" \n"},{"type":"tag","children":[{"type":"text","data":"04"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"// to do a pop :"}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"05"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"tag","children":[{"type":"text","data":"var"}],"name":"span","attribs":{"className":"token keyword"}},{"type":"text","data":" val "},{"type":"tag","children":[{"type":"text","data":"="}],"name":"span","attribs":{"className":"token operator"}},{"type":"text","data":"  myStack"},{"type":"tag","children":[{"type":"text","data":"["}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":"myStacksLength"},{"type":"tag","children":[{"type":"text","data":"--"}],"name":"span","attribs":{"className":"token operator"}},{"type":"tag","children":[{"type":"text","data":"]"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"tag","children":[{"type":"text","data":";"}],"name":"span","attribs":{"className":"token punctuation"}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"// you might want to check "}],"name":"span","attribs":{"className":"token comment"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"06"}],"name":"span","attribs":{"style":{"userSelect":"none"},"className":"line-numbers-rows"}},{"type":"text","data":"                                      "},{"type":"tag","children":[{"type":"text","data":"// myStacksLenght before..."}],"name":"span","attribs":{"className":"token comment"}}],"name":"pre","attribs":{"className":"prismjs js rally-runner  "}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"这样可以尽可能的避免分配和收回内存了。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"#"}],"name":"a","attribs":{"href":"#think-it-as-an-object","className":"markdownIt-Anchor"}},{"type":"text","data":" Think It As An Object"}],"name":"h1","attribs":{"id":"think-it-as-an-object"}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"因为 JavaScript 的数组其实就是用对象来实现的，因此类数组对象的存在完全合理，也不应该是所谓 “糟粕” 。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"通过构造器 "},{"type":"tag","children":[{"type":"text","data":"FakeArray"}],"name":"code","attribs":{}},{"type":"text","data":" 我们可以构造出极像数组的类数组对象，它完全拥有数组的全部原生方法，在一般情况下，我们可以合理认为，它跟普通数组并无二致了。"}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[],"name":"hr","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"后面的大部分在讨论性能问题，我刚刚自己试了下主要的结论是："}],"name":"p","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"push"}],"name":"code","attribs":{}},{"type":"text","data":" "},{"type":"tag","children":[{"type":"text","data":"pop"}],"name":"code","attribs":{}},{"type":"text","data":" 这些改变数组长度的操作确实挺慢的"}],"name":"li","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"text","data":"反过来遍历几乎不会有什么影响"}],"name":"li","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"arr[0]"}],"name":"code","attribs":{}},{"type":"text","data":" VS "},{"type":"tag","children":[{"type":"text","data":"arr[&quot;0&quot;]"}],"name":"code","attribs":{}},{"type":"text","data":" 几乎没有区别"}],"name":"li","attribs":{}},{"type":"text","data":"\n"},{"type":"tag","children":[{"type":"tag","children":[{"type":"text","data":"([])[0]"}],"name":"code","attribs":{}},{"type":"text","data":" VS "},{"type":"tag","children":[{"type":"text","data":"({})[0]"}],"name":"code","attribs":{}},{"type":"text","data":" 几乎没有区别"}],"name":"li","attribs":{}},{"type":"text","data":"\n"}],"name":"ol","attribs":{}},{"type":"text","data":"\n"}],"rawContent":""}}},"HomeApi":{"loaded":false,"loading":false,"error":null,"dataMap":{}},"TimeLineApiState":{"loaded":false,"loading":false,"error":null,"dataMap":{}},"SettingApi":{"loaded":false,"loading":false,"error":null,"dataMap":{}},"LaunchpadApi":{"loaded":false,"loading":false,"error":null,"dataMap":{}}}</script>
<!--SCRIPT-->
</body>
</html>
